<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">Posting Asynchronous Requests | IOTA Smart Contract Protocol</title><meta data-react-helmet="true" property="og:url" content="https://iscp.docs.iota.org/docs/guide/schema/post/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Posting Asynchronous Requests | IOTA Smart Contract Protocol"><meta data-react-helmet="true" name="description" content="Asynchronous function calls between smart contracts are posted as requests on the Tangle."><meta data-react-helmet="true" property="og:description" content="Asynchronous function calls between smart contracts are posted as requests on the Tangle."><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://iscp.docs.iota.org/docs/guide/schema/post/"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/schema/post/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/schema/post/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c3cdf61a.css">
<link rel="preload" href="/assets/js/runtime~main.dc1ec7b7.js" as="script">
<link rel="preload" href="/assets/js/main.e408bb30.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">ISCP</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/overview/">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Core Concepts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ISCP Chains and Nodes</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Rust/WASM</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/rust_wasm/introduction/">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Schema tool</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/intro/">Smart Contract Schemas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/proxies/">Data Access Proxies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/types/">WasmLib Data Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/context/">Function Call Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/schema/">Smart Contract Schema Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/usage/">Using the Schema Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/structs/">Structured Data Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/typedefs/">Type Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/state/">Smart Contract State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/funcs/">Function Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/access/">Limiting Access</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/params/">Function Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/results/">Function Results</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/thunks/">Thunk Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/views/">View-Only Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/init/">Smart Contract Initialization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/transfers/">Token Transfers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/funcdesc/">Function Descriptors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/call/">Calling Functions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/guide/schema/post/">Posting Asynchronous Requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/test/">Testing Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/examples/">Example Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/timelock/">Colored Tokens and Time Locks</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">EVM</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Example projects</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/contribute/">Contribute</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Posting Asynchronous Requests</h1></header><p>Asynchronous function calls between smart contracts are posted as requests on the Tangle.
They allow you to invoke any smart contract function that is not a View on any smart
contract chain. You will notice that the behavior is very similar to a normal function
call, but instead of using the call() method of the <code>func</code> member in the function
descriptor you will now use the post() or post_to_chain() methods. The former posts the
request within the current chain, and the latter takes the chain ID of the desired chain
as parameter.</p><p>In addition to the previously discussed transfer_iotas() and of_contract() methods you can
modify the behavior further by providing a delay() in seconds, which enables delayed
execution of the request. Note that this is of particular interest to smart contracts that
need a delayed action, like betting contracts with a timed betting round, or to create
time-lock functionality in a smart contract. Here&#x27;s how that works:</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Go</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Rust</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">eor </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ScFuncs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EndOfRound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">eor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Func</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Delay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TransferIotas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">let eor = ScFuncs::end_of_round(ctx);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">eor.func.delay(3600).transfer_iotas(1).post();</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></div><p>Note that an asynchronous request always needs to send at least 1 token, because it is
posted as a request on the Tangle, and it is not possible to have a request without a
transfer. So if you post to a function that expects tokens you just specify the amount of
tokens required, but if you post to a function that does not expect any tokens then you
still have to provide 1 iota.</p><p>Also note that providing a delay() before a call() will result in a run-time error. We do
not know the intention of the user until the actual call() or post() is encountered, so we
cannot check for this at compile-time unless we are willing to accept a lot of extra
overhead. It should not really be a problem because using delay() is rare, anyway, and
using it with call() cannot have been the intention.</p><p>The function that posts the request through the function descriptor will immediately
continue execution and does not wait for its completion. Therefore, it is not possible to
directly retrieve the return values from such a call.</p><p>If you need some return values you will have to create a mechanism that can do so, for
example by providing a callback chain/contract/function combination as part of the input
parameters of the requested function, so that upon completion that function can
asynchronously post the results to the indicated function. It will require a certain
degree of cooperation between both smart contracts. In the future we will probably be
looking at providing a generic mechanism for this.</p><p>In the next section we will look at how we can use the function descriptors when testing
smart contracts with Solo.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/chronicle.rs/tree/main/docs/docs/guide/schema/post.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guide/schema/call/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Calling Functions</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guide/schema/test/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Smart Contracts Â»</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/">Overview</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.dc1ec7b7.js"></script>
<script src="/assets/js/main.e408bb30.js"></script>
</body>
</html>
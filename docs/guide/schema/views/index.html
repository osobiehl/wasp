<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">View-Only Functions | IOTA Smart Contract Protocol</title><meta data-react-helmet="true" property="og:url" content="https://iscp.docs.iota.org/docs/guide/schema/views/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="View-Only Functions | IOTA Smart Contract Protocol"><meta data-react-helmet="true" name="description" content="View-only functions, or Views for short, are smart contract functions that only allow you"><meta data-react-helmet="true" property="og:description" content="View-only functions, or Views for short, are smart contract functions that only allow you"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://iscp.docs.iota.org/docs/guide/schema/views/"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/schema/views/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/schema/views/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c3cdf61a.css">
<link rel="preload" href="/assets/js/runtime~main.109354f2.js" as="script">
<link rel="preload" href="/assets/js/main.8cf8ae9d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">ISCP</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/overview/">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Core Concepts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ISCP Chains and Nodes</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Rust/WASM</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/rust_wasm/introduction/">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Schema tool</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/intro/">Smart Contract Schemas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/proxies/">Data Access Proxies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/types/">WasmLib Data Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/context/">Function Call Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/schema/">Smart Contract Schema Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/usage/">Using the Schema Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/structs/">Structured Data Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/typedefs/">Type Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/state/">Smart Contract State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/funcs/">Function Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/access/">Limiting Access</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/params/">Function Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/results/">Function Results</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/thunks/">Thunk Functions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/guide/schema/views/">View-Only Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/init/">Smart Contract Initialization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/transfers/">Token Transfers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/funcdesc/">Function Descriptors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/call/">Calling Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/post/">Posting Asynchronous Requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/test/">Testing Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/examples/">Example Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/schema/timelock/">Colored Tokens and Time Locks</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">EVM</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Example projects</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/contribute/">Contribute</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">View-Only Functions</h1></header><p>View-only functions, or Views for short, are smart contract functions that only allow you
to <em>retrieve</em> state information about the smart contract. They have a special, limited
ISCP function context that does not allow access to functionality that could result in
changes to the smart contract state. That means that all access to the state storage will
be through immutable proxies. It also means that they cannot receive or transfer tokens,
because changes to the smart contract account are by definition state changes as well.</p><p>Views are allowed to call other views on the same chain, but they cannot call any non-view
smart contract function, nor can they post cross-chain requests.</p><p>View functions will always return some data to their caller. It would be silly not to
return data from a View because by definition it cannot have any other side effects that
show up elsewhere.</p><p>For demonstration purposes we provided a View function with the <code>dividend</code> smart contract,
called &#x27;getFactor&#x27;:</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Go</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Rust</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// &#x27;getFactor&#x27; is a simple View function. It will retrieve the factor</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// associated with the (mandatory) address parameter it was provided with.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">viewGetFactor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx wasmlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ScViewContext</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">GetFactorContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Since we are sure that the &#x27;address&#x27; parameter actually exists we can</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// retrieve its actual value into an ScAddress value type.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> address wasmlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ScAddress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Create an ScImmutableMap proxy to the &#x27;members&#x27; map in the state storage.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Note that for views this is an *immutable* map as opposed to the *mutable*</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// map we can access from the *mutable* state that gets passed to funcs.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> members MapAddressToImmutableInt64 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Members</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Retrieve the factor associated with the address parameter.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> factor </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> members</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GetInt64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Set the factor in the results map of the function context.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// The contents of this results map is returned to the caller of the function.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Factor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// &#x27;getFactor&#x27; is a simple View function. It will retrieve the factor</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// associated with the (mandatory) address parameter it was provided with.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn view_get_factor(_ctx: &amp;ScViewContext, f: &amp;GetFactorContext) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Since we are sure that the &#x27;address&#x27; parameter actually exists we can</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // retrieve its actual value into an ScAddress value type.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let address: ScAddress = f.params.address().value();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create an immutable map proxy to the &#x27;members&#x27; map in the state storage.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Note that for views this is an *immutable* map as opposed to the *mutable*</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // map we can access from the *mutable* state that gets passed to funcs.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let members: MapAddressToImmutableInt64 = f.state.members();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Retrieve the factor associated with the address parameter.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let factor: i64 = members.get_int64(&amp;address).value();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set the factor in the results map of the function context.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // The contents of this results map is returned to the caller of the function.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    f.results.factor().set_value(factor);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></div><p>Return values are passed to the caller through the predefined <code>results</code> map associated
with the ISCP function context. Again, this works the same way as for Funcs, although
Funcs do not necessarily return values to the caller. The schema tool will set up a
function-specific <code>results</code> structure with proxies to the result fields in this map.</p><p>In the next section we will look at smart contract initialization.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/chronicle.rs/tree/main/docs/docs/guide/schema/views.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guide/schema/thunks/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Thunk Functions</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guide/schema/init/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Smart Contract Initialization Â»</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/">Overview</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.109354f2.js"></script>
<script src="/assets/js/main.8cf8ae9d.js"></script>
</body>
</html>